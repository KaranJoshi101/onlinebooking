<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
    <link rel="stylesheet" href="/static/user_dash.css">
    <link rel="stylesheet" href="/static/selecthost.css">
    <link rel="shortcut icon" href="favicon/favicon.ico">
<link rel="icon" type="image/gif" href="favicon/animated_favicon1.gif">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand"><img class="logo" src="/static/images/logo.png"  width="45" height="50">Book My Doctor</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <div class="collapse navbar-collapse d-flex justify-content-around" id="navbarSupportedContent">
      
      <ul class="navbar-nav">
        <li class="nav-item active px-5">
          <button class="nav-link" id="appointmentBtn">Appointment</button>
        </li>
        
          <li class="nav-item active px-5">
            <a type="button" href="/{{user.id}}/addMember" class="nav-link">Add Member</a>
          </li>
        
          <li class="nav-item active px-5">
            <button id="profileBtn" class="nav-link" href="/{{user.id}}/summary">View Profile</button>
          </li>
        </ul>
        
        <div></div>
      
      <div>
        <a type="button" class="btn btn-danger" href="/" >Logout</a>
      </div>
          
          
      
    </div>
  </nav>
      <div class="container-sm col-lg-6 col-md-10 col-sm-14 shadow-lg p-3  bg-white rounded" id="appointment" style="margin-top:120px ;padding: 20px 20px 20px 20px; border-radius: 2%;">
        <ul margin="2px">
          {%for patient,patientlist,appointment in patientsappointment%}
            <ul class="list-group patient-appointment" id="{{patient.id}}" style="display: none;">
              {%if patientlist|length%}
              {%for plist in patientlist%}
                <li class="list-group-item d-flex justify-content-between">Date: {{appointment[loop.index-1].date}}, Token No: {{plist.token}}, Status: {{plist.status}}  <a type="button" class="btn btn-info" href="/{{patient.id}}/{{appointment[loop.index-1].id}}/{{plist.id}}">View Details</a></li>
              {%endfor%}
              {%else%}
              <li class="list-group-item" >No appointment yet!!</li>
              {%endif%}
              </ul>
              {%endfor%}
        </ul>
        <a type="button" class="btn btn-success" id="bookAppointmentBtn">
            +Book Appointment
        </a>
      </div>
      

      <div class="container col-6 shadow p-3 mb-5 bg-body rounded top-cont  pb-5" id="bookAppointment">
        <h2 id="book-appointment" class="pt-3">Book Appointment</h2>
        <button type="button" class="btn btn-dark btn-sm" id="form-slot-back"> > Back</button>
        <div class="select-detail-hospital pt-5">
            <form>
                <div class="d-flex flex-column justify-content-center">
                    <h5>Select State</h5>
                    <select id="state" class="form-select" aria-label="Default select example" name=state required>
                        <option value="" selected>Select State</option>
                        {%for state in states%} 
                        <option value="{{state}}">{{state}}</option>
                        {%endfor%}
                      </select>
                </div>
                <div class="d-flex flex-column justify-content-center select-box">
                    <h5>Select City</h5>
                    <select class="form-select" id="city" aria-label="Default select example" disabled>
                        <option value="" selected>Select City</option>
                        {%for i in cities%}
                            {%for j in cities[i]%}
                            <option class="cities" id="{{i}}" value="{{j}}" style="display: none;">{{j}}</option>
                            {%endfor%}
                        {%endfor%}
                      </select>
                </div>
                <div class="d-flex flex-column justify-content-center select-box">
                    <h5>Select Hospital</h5>
                    <select class="form-select" id="hospital" aria-label="Default select example" disabled>
                        <option value="" selected>Select Hospital</option>
                        {%for hospital in hospitals%}
                            <option class="{{hospital.city}}"  value="{{hospital.id}}" style="display: none;">{{hospital.name}}</option>
                            
                        {%endfor%}
                      </select>
                </div>
                <div class="d-flex flex-column justify-content-center select-box">
                    <h5>Select Department</h5>
                    <select class="form-select" id="dept" aria-label="Default select example" disabled>
                        <option value="" selected>Select Department</option>
                        {%for department in departments%}
                            <option class="{{department.hid}}" style="display: none;" value="{{department.id}}">{{department.name}}</option>
                        {%endfor%}
                      </select>
                </div>
                <div class="d-flex justify-content-end">
                    <button type="button" class="btn btn-success px-4 me-md-2 mt-4 select-slot-btn" id="nextBtn" disabled>Next></button>
                </div>    
            </form>
        </div>
        

        <div  id="form-slot">
            <form action="/{{user.id}}/book" method="post">
                <div class="d-flex flex-column justify-content-center select-box">
                    <h5>Select Doctor</h5>
                    <select class="form-select" id="doctor" name="deptdoc" aria-label="Default select example" disabled>
                        <option value="" selected>Select Doctor</option>
                        {%for deptdoc,doc in deptdocs%}
                            <option class="{{deptdoc.deptid}}" value="{{deptdoc.id}}" style="display: none;">Dr. {{doc.name}}</option>
                        {%endfor%}
                      </select>
                </div>
                <div class="mb-5">
                  <label for="meeting-time" class="pt-3"><h5>Select Date</h5></label>
                <input
                  type="date"
                  id="bookdate"
                  name="bookdate"
                  
                  min="{{date.date()}}"
                  max="{{vdate.date()}}" />
                </div>
                <div class="d-flex flex-column justify-content-center select-box">
                  <h5>Select Slot</h5>
                  <select class="form-select" id="slot" aria-label="Default select example" name="slot" disabled>
                      <option value="" selected>Select Slot</option>
                      {%for days in slots%}
                          {%for slot in slots[days]%}
                          <option class="{{days.ddid}} {{days.day}}" value="{{slot.id}}" style="display: none;" >{{slot.from_.strftime("%I:%M%p")}} - {{slot.to.strftime("%I:%M%p")}}</option>
                      
                          {%endfor%}
                          {%endfor%}
                    </select>
              </div>
                
                  {%for doc,deptdoc,days in docdays%}
                <p id='{{deptdoc.id}}' class="docDay text-center " style="display: none; font-weight: bold;font-stretch:expanded;color: green;">Dr. {{doc.name}} is available on {{days|join(" and ")}} </p>
                  {%endfor%}

                <input id="patient" name="patient" type="text" style="display: none;">  
                <div class="d-flex justify-content-end pt-5">
                    <button type="submit" class="btn btn-success px-4 me-md-2 select-book-btn mt-5" id="bookBtn" disabled>Book Appointment</button>
                </div>
            </form>
        </div>

        


    </div>

    <div class="container-sm col-lg-4 col-md-8 col-sm-12 shadow-lg p-3  bg-white rounded" id="profile" style="display:none;margin-top:120px ;padding: 20px 20px 20px 20px; border-radius: 2%;">
      <div class="text-center mb-3"><h3>Members</h3></div>
      <ul margin="2px">
          <div class="list-group">
            <div class="d-flex justify-content-between">
              <p>{{patients[0].name}} (primary)</p>
              <button id="{{patients[0].id}}" class="btn btn-primary member" disabled>selected</button>
            </div>
            {%for patient in patients[1:]%}
            <div class="d-flex justify-content-between mt-3">
              <p>{{patient.name}}</p>
              <button id="{{patient.id}}" class="btn btn-primary member">select</button>
            </div>
            
              {%endfor%}
            </div>
      </ul>
    
    </div>

    <script src="/static/selecthost.js"></script>
    <script src="/static/cities.js"></script>
    <script src="/static/user_dash.js"></script>
</body>
</html>
